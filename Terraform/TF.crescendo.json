{
   "$schema": "https://aka.ms/PowerShell/Crescendo/Schemas/2021-11",
   "Commands": [
        {
            "Verb": "Get",
            "Noun": "TerraformVersion",
            "Aliases": ["Get-TFVersion","tfVersion"],
            "Description": "Calls terraform version and converts the result into an object",
            "Usage": {
                "Synopsis": "Gets the Terraform Version",
                "HasOptions": false,
                "SupportsFlags": false
            },
            "OriginalName": "terraform",
            "OriginalCommandElements": [
                "version",
                "-json"
            ],
            "OutputHandlers": [
                {
                "ParameterSetName": "Default",
                "HandlerType": "Function",
                "Handler": "tfVersionJsonToObject",
                "StreamOutput": true
                }
            ]
        },
        {
            "Verb": "New",
            "Noun": "TerraformPlan",
            "Aliases": ["New-TFPlan","tfPlan"],
            "Usage": { "Synopsis": "Builds a new terraform plan from the current configuration"},
            "Description": "Calls terraform plan, optionally with -Destroy and -Out <file> options, returns planned steps as objects.",
            "OriginalName": "terraform",
            "OriginalCommandElements": [
                "plan",
                "-json"
            ],
            "Parameters": [
                {"Name": "Directory",
                "OriginalName": "-chdir=",
                "NoGap": true,
                "ApplyToExecutable": true
                },
                {"Name": "OutFile",
                "OriginalName": "-out",
                "OriginalPosition": 0,
                "Position": 0,
                "ParameterType": "String"
                },
                {"Name": "Destroy",
                 "OriginalName": "-destroy",
                 "ParameterType": "Switch",
                 "OriginalPosition": 1
                }
            ],
            "OutputHandlers": [
                {
                "ParameterSetName": "Default",
                "HandlerType": "Function",
                "Handler": "tfPlanJsonToObject",
                "StreamOutput": true
                }
            ]
        },
        {
            "Verb": "New",
            "Noun": "TerraformGraph",
            "Aliases": ["New-TFGraph","tfGraph"] ,
            "Usage": {"Synopsis": "Draws a graph of the resources in the current configuration"},
            "Description": "Calls terraform graph, if the PSGraphModule is present converts the graphviz output to something viewable",
            "OriginalName": "terraform",
            "OriginalCommandElements": [
                "graph"
            ],
            "Parameters": [
                {
                    "Name": "Path",
                    "Position": 0,
                    "Description": "Path for the outputfile",
                    "ParameterType": "String",
                    "OriginalPosition": -1
                },
                {
                    "Name": "ShowGraph",
                    "Position": 1,
                    "ParameterType": "switch",
                    "OriginalPosition": -1
                }
            ],
            "OutputHandlers": [
                {
                "ParameterSetName": "Default",
                "StreamOutput": true,
                "HandlerType": "Function",
                "Handler": "rendertfgraph -Path $Path -ShowGraph:$ShowGraph $input"
                }
            ]
        },
        {
            "Verb": "Test",
            "Noun": "TerraformFormat",
            "Usage": {"Synopsis": "Calls terraform fmt -check and returns true or false depending on whether the format check passed"},
            "OriginalName": "terraform",
            "OriginalCommandElements": [ "fmt", "-check"],
            "Parameters": [
                {
                    "Name": "Recurse",
                    "Aliases": ["Recursive"],
                    "Position": 0,
                    "OriginalPosition": 2,
                    "OriginalName": "-recursive",
                    "ParameterType": "switch"
                }
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "StreamOutput": false,
                    "HandlerType": "Function",
                    "Handler": "tfFormatCheckOK"
                }
            ]
        },
        {
            "Verb": "Format",
            "Noun": "TerraformConfiguration",
            "Aliases": ["Format-TF","tffmt"],
            "Usage": {"Synopsis": "Calls terraform fmt and formats files "},
            "OriginalName": "terraform",
            "OriginalCommandElements": [ "fmt"],
            "Parameters": [
                {
                    "Name": "Recurse",
                    "Aliases": ["Recursive"],
                    "Position": 0,
                    "OriginalPosition": 2,
                    "OriginalName": "-recursive",
                    "ParameterType": "switch"
                }
            ],
            "OutputHandlers": [
                {
                    "ParameterSetName": "Default",
                    "StreamOutput": false,
                    "HandlerType": "Function",
                    "Handler": "tfFormatResults"
                }
            ]
        },
        {
            "Verb": "Get",
            "Noun": "TerraformState",
            "Aliases": ["Get-TFState","tfshow"],
            "Usage": {"Synopsis": "Calls terraform state and converts the results to objects"},
            "OriginalName": "terraform",
            "OriginalCommandElements": ["show", "-json"],
            "Parameters": [
            {
            "Name": "Address",
            "OriginalPosition": -1,
            "DefaultValue": "*",
            "ParameterType": "String",
            "Description": "If specified, will filter the results to the selected address(es). Wildcards are allowed. "
            }
            ],
            "OutputHandlers": [{
                "ParameterSetName": "Default",
                "StreamOutput": true,
                "Handler": "tfStateJsonToObject -Address $Address $input",
                "HandlerType": "Function"
            }]
        }
    ]
}

